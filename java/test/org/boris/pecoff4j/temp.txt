// Parse resources if present
        // TODO: ensure the resource table covers the .rsrc section
        byte[] res = pf.getSectionTable().getSectionData(".rsrc");
        if (res != null &&
                pf.getOptionalHeader().getResourceTable().getSize() > 0) {
            pf
                    .setResourceDirectory(readResourceDirectory(res, pf
                            .getOptionalHeader().getResourceTable()
                            .getVirtualAddress()));
        }

        // Parse import directory table
        res = pf.getSectionTable().getSectionData(".rdata");
        if (res != null) {
            IDataReader drr = new ByteArrayDataReader(res);
            int itva = pf.getOptionalHeader().getImportTable()
                    .getVirtualAddress();
            int rdva = pf.getSectionTable().getSection(".rdata")
                    .getVirtualAddress();
            int offset = itva - rdva;
            // Sanity check
            if (offset > 0 && offset < res.length) {
                drr.jumpTo(itva - rdva);
                pf.setImportDirectory(readImportDirectory(drr, pf
                        .getSectionTable().getSection(".rdata")
                        .getVirtualAddress()));
            }

            if (pf.getOptionalHeader().getLoadConfigTable().getSize() > 0) {
                drr.jumpTo(pf.getOptionalHeader().getLoadConfigTable()
                        .getVirtualAddress() -
                        pf.getSectionTable().getSection(".rdata")
                                .getVirtualAddress());
                pf.setLoadConfigDirectory(readLoadConfigDirectory(drr));
            }
        }